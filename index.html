<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>Комічне в мемах воєнного часу — 2025</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
  body {font-family:'Comic Sans MS',Arial;background:linear-gradient(135deg,#0057b7,#ffd700);color:white;margin:0;padding:20px;min-height:100vh;}
  h1,h2 {text-align:center;}
  .tabs {display:flex;flex-wrap:wrap;justify-content:center;gap:15px;margin:30px 0;}
  .tab {padding:15px 30px;background:#000;color:#ffd700;border:3px solid #ffd700;border-radius:15px;cursor:pointer;font-weight:bold;}
  .tab.active {background:#ffd700;color:#000;}
  .content {display:none;background:rgba(0,0,0,0.85);padding:40px;border-radius:25px;max-width:1100px;margin:20px auto;}
  .content.active {display:block;}
  .section {background:rgba(0,50,100,0.9);padding:25px;margin:20px 0;border:4px dashed #ffd700;border-radius:15px;min-height:240px;}
  .meme {width:190px;margin:10px;border:5px solid #fff;border-radius:15px;cursor:grab;box-shadow:0 0 20px #ff0;transition:0.3s;position:relative;display:inline-block;}
  .meme:active {transform:scale(1.15);}
  .meme-bank {display:flex;flex-wrap:wrap;justify-content:center;gap:15px;padding:20px;background:rgba(0,0,0,0.5);border-radius:20px;}
  button {background:#ffd700;color:#000;padding:14px 28px;margin:12px;font-size:1.2em;border:none;border-radius:12px;cursor:pointer;font-weight:bold;}
  button:hover {background:#fff;}
  .admin {background:#c00;padding:15px;text-align:center;display:none;font-weight:bold;}
  #adminLogin {text-align:center;margin:30px;}
  select, input {padding:12px;margin:10px;width:90%;border-radius:10px;font-size:1.1em;}
  .search-result, .quest-result {text-align:center;margin:40px;padding:30px;background:#000;border:5px solid #ffd700;border-radius:20px;}
  .search-result img, .quest-result img {max-width:90%;border-radius:20px;margin:20px 0;}
  .delete-btn {position:absolute;top:5px;right:5px;background:red;color:white;border:none;border-radius:50%;width:30px;height:30px;font-size:18px;cursor:pointer;display:none;}
  .meme:hover .delete-btn {display:block;}
</style>
</head>
<body>

<h1>КОМІЧНЕ В МЕМАХ ВОЄННОГО ЧАСУ</h1>

<div id="adminLogin">
  <input type="password" id="pass" placeholder="Пароль адміна">
  <button onclick="login()">Увійти</button>
</div>
<div id="adminPanel" class="admin">АДМІН-РЕЖИМ <button onclick="logout()">Вийти</button></div>

<div class="tabs">
  <div class="tab active" onclick="openTab('constructor')">Конструктор</div>
  <div class="tab" onclick="openTab('quest')">Квест</div>
  <div class="tab" onclick="openTab('search')">Пошук за інтенцією</div>
  <div class="tab" onclick="openTab('gallery')">Готовий каталог</div>
  <div class="tab" onclick="openTab('add')">Додати мем</div>
</div>

<!-- КОНСТРУКТОР — нові назви -->
<div id="constructor" class="content active">
  <h2 style="text-align:center;">Перетягни меми в розділи</h2>
  <div id="memeBank" class="meme-bank"></div>
  <h2 style="text-align:center;margin-top:50px;">Інтенції</h2>
  <div class="section" ondrop="drop(event)" ondragover="allowDrop(event)" id="s1">Підтримка морального духу</div>
  <div class="section" ondrop="drop(event)" ondragover="allowDrop(event)" id="s2">Висміювання ворога</div>
  <div class="section" ondrop="drop(event)" ondragover="allowDrop(event)" id="s3">Ідеалізація особистості</div>
  <div class="section" ondrop="drop(event)" ondragover="allowDrop(event)" id="s4">Дискредитація ворога</div>
  <div class="section" ondrop="drop(event)" ondragover="allowDrop(event)" id="s5">Підтримка морального духу українського народу</div>
</div>

<!-- КВЕСТ — видає мем з каталогу -->
<div id="quest" class="content">
  <h2>Який ти мем воєнного часу?</h2>
  <div id="questionContainer">
    <div class="question active" id="q1"><p><strong>1.</strong> Повітряна тривога. Ти:</p>
      <button onclick="nextQ(1,'a')">Біжу в укриття з котом</button><br><br>
      <button onclick="nextQ(1,'b')">«Та я ще 5 хвилин…»</button><br><br>
      <button onclick="nextQ(1,'c')">Вмикаю «Байрактар»</button>
    </div>
    <div class="question" id="q2"><p><strong>2.</strong> «Бавовна»:</p>
      <button onclick="nextQ(2,'a')">Чорнобаївка №38</button><br><br>
      <button onclick="nextQ(2,'b')">Ставлю сердечко ЗСУ</button><br><br>
      <button onclick="nextQ(2,'c')">Шукаю мем</button>
    </div>
    <!-- Додай ще 8 питань сам — або я зроблю -->
  </div>
  <div id="questResult" class="quest-result hidden"></div>
</div>

<!-- ПОШУК ЗА ІНТЕНЦІЄЮ ТА ЗАСОБОМ -->
<div id="search" class="content">
  <h2>Пошук за інтенцією та засобом</h2>
  <select id="intentSelect">
    <option value="">Обери інтенцію</option>
    <option>Підтримка морального духу</option>
    <option>Висміювання ворога</option>
    <option>Ідеалізація особистості</option>
    <option>Дискредитація ворога</option>
    <option>Under підтримка морального духу українського народу</option>
  </select>
  <select id="deviceSelect">
    <option value="">Обери засіб</option>
    <option>гумор</option>
    <option>іронія</option>
    <option>сатира</option>
    <option>сарказм</option>
  </select>
  <button onclick="searchMeme()">Знайти</button>
  <div id="searchResult" class="search-result"></div>
</div>

<!-- ГАЛЕРЕЯ + ДОДАТИ МЕМ — як раніше -->

<script>
// Твій Supabase
const supabase = window.supabase.createClient(
  'https://goklujojesauzxwpdqdp.supabase.co',
  'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imdva2x1am9qZXNhdXp4d3BkcWRwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ4NTgxNjgsImV4cCI6MjA4MDQzNDE2OH0.iRo0Sz54Us3eeUweqxq4NuYAIjPSIdTWgfCgZhec8Fc'
);

const ADMIN_PASS = 'Lyceum53';
let isAdmin = false;

// === КВЕСТ ===
let qAnswers = [];

function nextQ(q, choice) {
  qAnswers[q-1] = choice;
  document.querySelectorAll('.question').forEach(el => el.classList.remove('active'));
  if (q < 10) {
    document.getElementById('q' + (q + 1)).classList.add('active');
  } else {
    showQuestMeme();
  }
}

async function showQuestMeme() {
  const { data } = await supabase.from('memes').select('*');
  if (!data || data.length === 0) {
    document.getElementById('questResult').innerHTML = '<p>Мемів немає — додай у вкладці "Додати мем"</p>';
  } else {
    const randomMeme = data[Math.floor(Math.random() * data.length)];
    document.getElementById('questResult').innerHTML = `
      <h2>Ти — цей мем!</h2>
      <img src="${randomMeme.src}">
      <p><strong>Інтенція:</strong> ${randomMeme.intent || 'невідомо'}<br>
         <strong>Засіб комічного:</strong> ${randomMeme.device || 'невідомо'}</p>
      <button onclick="location.reload()">Пройти ще раз</button>
    `;
  }
  document.getElementById('questResult').classList.remove('hidden');
  document.getElementById('questionContainer').style.display = 'none';
}

// Решта коду (додавання, видалення, пошук, drag&drop) — як у попередній версії

loadMemes();
</script>
</body>
</html>
